<!--
Copyright 2013 The Polymer Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="chart-js-import.html">

/**
*
* Chart.js element
*
* Easy, object oriented client side graphs for designers and developers.
*
* http://www.chartjs.org
*
* @class chart-js
* @blurb Easy, object oriented client side graphs for designers and developers.
* @snap http://polymer.github.io/chart-js/components/chart-js/snap.png
* @origin-url http://www.chartjs.org/
* @author The Polymer Authors
* @categories Charts and Graphs
* @license Three-clause BSD
* @license-url //polymer.github.io/chart-js/components/chart-js/LICENSE
*
*/
<polymer-element name="chart-js" attributes="data kind options width height">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        <div>
            <canvas id="chart"></canvas>
        </div>
    </template>
    <script>
        Polymer('chart-js', {
            kind: '',
            data: null,
            options: null,
            width: 400,
            height: 200,
            created: function() {
                console.log('created called');
                this.options = {
                    responsive: true
                };
            },
            attached: function () {

                console.log('offsetWidth: ' + this.offsetWidth);
                this.$.chart.width = this.width;
                this.$.chart.height = this.height;
                //this.$.chart.width = Math.max(this.offsetWidth, 100);
                //this.$.chart.height = Math.max(this.offsetHeight, 100);
                //Get the context of the canvas element we want to select
                this.ctx = this.$.chart.getContext('2d');
                this.updateChart();

            },
            updateChart: function () {
                if (this.data && this.ctx) {
                    var chart = new Chart(this.ctx);
                    var kind = this.kind;
                    this.chart = chart[kind](this.data, this.options);
                }
            },
            dataChanged: function () {
                this.updateChart();
            },
            kindChanged: function () {
                this.updateChart();
            }
        });
    </script>
</polymer-element>
